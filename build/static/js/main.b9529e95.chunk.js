(this.webpackJsonpexample01=this.webpackJsonpexample01||[]).push([[0],{273:function(e,t,n){e.exports=n(498)},471:function(e,t,n){},477:function(e,t,n){},496:function(e,t,n){},497:function(e,t,n){},498:function(e,t,n){"use strict";n.r(t);n(274),n(283),n(466);var a=n(0),r=n.n(a),o=n(130),c=n.n(o),s=n(270),u=(n(471),n(52)),i=n(255),l=function(e){var t=e.authenticated,n=e.loading,a=e.component,o=e.render,c=Object(i.a)(e,["authenticated","loading","component","render"]);return r.a.createElement(s.b,Object.assign({},c,{render:function(e){return n?null:Object(s.e)(e.location.pathname,{path:"/dashboard",exact:!0})&&!t?r.a.createElement(s.a,{to:{pathname:"/",state:{from:e.location}}}):Object(s.e)(e.location.pathname,{path:"/",exact:!0})&&t?r.a.createElement(s.a,{to:{pathname:"/dashboard",state:{from:e.location}}}):a?r.a.createElement(a,e):o?o(e):null}}))},d=n(47),m=n.n(d),p=n(77),h=n(268),v=n(145),f=n(501),b=n(507),E=n(502),O=n(262),g=n(503),w=(n(477),n(114)),j=n(260),k=n.n(j),x=function(){var e=Object(p.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url||"/",e.prev=1,e.next=4,k()(Object(w.a)({},t,{url:n,validateStatus:function(e){return e>=200&&e<300||[400,401,500].includes(e)}}));case 4:if(a=e.sent,![400,401].includes(a.status)){e.next=7;break}return e.abrupt("return",a);case 7:if(![500].includes(a.status)){e.next=9;break}return e.abrupt("return",Object(w.a)({},a,{data:{description:"sorry, but server is die =)",code:"Internal Server Error"}}));case 9:return e.abrupt("return",a);case 12:throw e.prev=12,e.t0=e.catch(1),e.t0;case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(p.a)(m.a.mark((function e(t){var n,a,r,o=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:0,e.prev=1,e.next=4,x(t);case 4:return a=e.sent,e.abrupt("return",a);case 8:if(e.prev=8,e.t0=e.catch(1),1!==(n+=1)){e.next=13;break}throw e.t0;case 13:return e.next=15,C(t,n);case 15:return r=e.sent,e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),S=function(e){return C(Object(w.a)({},e,{method:"GET"}))},y=function(e){return C(Object(w.a)({},e,{method:"POST"}))},_=function(e){return"".concat("https://work.vint-x.net/api/").concat(e)},N=function(e){var t=e.username,n=e.password;return y({url:_("login"),data:{username:t,password:n}})},I=function(e){var t=e.token;return S({url:_("subscribe"),headers:{"x-test-app-jwt-token":t}})},B=function(e){var t=e.onSetToken,n=Object(a.useState)(""),o=Object(u.a)(n,2),c=o[0],s=o[1],i=Object(a.useState)(!1),l=Object(u.a)(i,2),d=l[0],w=l[1],j=Object(h.a)({validationSchema:v.a({username:v.b().required(),password:v.b().required()}),initialValues:{username:"",password:""},onSubmit:function(){var e=Object(p.a)(m.a.mark((function e(n){var a,r,o,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(""),w(!0),e.prev=2,e.next=5,N(n);case 5:a=e.sent,r=a.data,o=a.headers,"code"in r?(j.setFieldValue("password",""),j.setErrors({username:"error",password:"error"}),s(r.description),w(!1)):(c=o["x-test-app-jwt-token"],t(c)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),s("No connection"),w(!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()}),k=j.errors.username||j.errors.password,x=j.values.password&&j.values.username&&j.isValid;return r.a.createElement(f.a,{className:"login-page__container"},r.a.createElement(b.a,{className:"login-page__form",onSubmit:j.handleSubmit},r.a.createElement(b.a.Group,{as:E.a},r.a.createElement(b.a.Label,{column:!0,sm:4},"Username"),r.a.createElement(O.a,{sm:8},r.a.createElement(b.a.Control,{autoFocus:!0,isInvalid:j.touched.username&&!!j.errors.username||!!c,disabled:d,type:"text",name:"username",value:j.values.username,onChange:j.handleChange,onBlur:j.handleBlur,isValid:j.touched.username&&!j.errors.username,placeholder:"user name"}))),r.a.createElement(b.a.Group,{as:E.a},r.a.createElement(b.a.Label,{column:!0,sm:4},"Password"),r.a.createElement(O.a,{sm:8},r.a.createElement(b.a.Control,{disabled:d,isInvalid:j.touched.password&&!!j.errors.password||!!c,type:"password",name:"password",value:j.values.password,onChange:j.handleChange,onBlur:j.handleBlur,isValid:j.touched.password&&!j.errors.password,placeholder:"password"}),k&&r.a.createElement(b.a.Control.Feedback,{type:"invalid"},c))),r.a.createElement(b.a.Group,{as:E.a},r.a.createElement(O.a,null,r.a.createElement(g.a,{type:"submit",disabled:!x||d},d?"Loading\u2026":"Sign In")))))},T=n(508),L=n(506),M=n(504),V=n(505),F=n(263),G=n.n(F),H=(n(496),n(264)),J=n(265);function P(e,t,n){return{nativeEvent:e.addEventListener(t,n),removeEvent:function(){e.removeEventListener(t,n)}}}var q,W=new(function(){function e(){Object(H.a)(this,e),this.count=void 0,this.onMessage=void 0,this.onOpen=void 0,this.onClose=void 0,this.onError=void 0,this.onConnectClose=void 0,this.url=void 0,this.instance=void 0,this.count=1}return Object(J.a)(e,[{key:"open",value:function(e){var t=this;this.url=e;var n=new WebSocket(e),a=P(n,"open",(function(e){t.onOpen&&t.onOpen(e)})),r=P(n,"message",(function(e){t.onMessage&&t.onMessage(e)})),o=P(n,"close",(function(e){switch(e.code){case 1e3:case 1006:break;default:t.reconnect()}t.onClose&&t.onClose(e)})),c=P(n,"error",(function(e){t.onError&&t.onError(e)}));this.instance=n,this.close=function(){a.removeEvent(),r.removeEvent(),o.removeEvent(),c.removeEvent(),n.close(1e3)}}},{key:"close",value:function(){}},{key:"reconnect",value:function(){this.count-=1,this.count<=0?this.onConnectClose&&this.onConnectClose():this.url&&this.open(this.url)}}]),e}()),D=function(e){var t=e.token,n=e.logOut,o=Object(a.useState)(!1),c=Object(u.a)(o,2),s=c[0],i=c[1],l=Object(a.useState)(0),d=Object(u.a)(l,2),h=d[0],v=d[1],b=Object(a.useState)(""),E=Object(u.a)(b,2),O=E[0],w=E[1];return Object(M.a)((function(){W.onOpen=function(){return i(!0)},W.onMessage=function(t){try{var n=JSON.parse(t.data);v(1e3*n.server_time),clearTimeout(q),q=setTimeout((function(){W.close(),e()}),1e3)}catch(a){}},W.onError=function(){return i(!1)},W.onClose=function(){return i(!1)};var e=function(){var e=Object(p.a)(m.a.mark((function e(){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I({token:t});case 3:n=e.sent,"code"in(a=n.data)?w(a.description):W.open(a.url),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),w("No connection"),W.close();case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();W.onConnectClose=function(){return e()},e().then()})),Object(V.a)((function(){q&&clearTimeout(q),W.close()})),r.a.createElement(f.a,{className:"dashboard-page__container"},r.a.createElement("div",{className:"dashboard-page__panel"},O?r.a.createElement(T.a,{variant:"danger"},O):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"WebSocket:"," ",r.a.createElement(L.a,{variant:s?"success":"danger"},s?"Connected":"Disconnected")),r.a.createElement("p",null,G()(h,"dd.MM.yy HH:mm:ss"))),r.a.createElement(g.a,{variant:"link",onClick:n},"Logout")))},U=(n(497),function(){return r.a.createElement(f.a,{className:"not-found-page__container"},r.a.createElement("div",{className:"not-found-page__text"},"Page not found"))});var z=function(){var e=function(e){var t=Object(a.useState)(localStorage.getItem(e)||""),n=Object(u.a)(t,2),r=n[0],o=n[1];return[r,Object(a.useCallback)((function(t){localStorage.setItem(e,t),o(t)}),[e]),Object(a.useCallback)((function(){localStorage.removeItem(e),o("")}),[e])]}("token"),t=Object(u.a)(e,3),n=t[0],o=t[1],c=t[2],i=Boolean(n);return r.a.createElement(s.d,null,r.a.createElement(l,{exact:!0,path:"/",authenticated:i,render:function(){return r.a.createElement(B,{onSetToken:o})}}),r.a.createElement(l,{path:"/dashboard",authenticated:i,render:function(){return r.a.createElement(D,{token:n,logOut:c})}}),r.a.createElement(l,{path:"*",authenticated:i,component:U}))},A=(0,n(58).createBrowserHistory)();c.a.render(r.a.createElement(s.c,{history:A},r.a.createElement(z,null)),document.getElementById("root"))}},[[273,1,2]]]);